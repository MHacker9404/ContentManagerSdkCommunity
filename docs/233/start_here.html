<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenText Content Manager SDK 23.3 and 23.4: Start here</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygenBase.css" rel="stylesheet" type="text/css" />
<link href="doxyStylesheet.css" rel="stylesheet" type="text/css"/>
<link href="doxySidebarFixes.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf_logo_white_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenText Content Manager SDK 23.3 and 23.4
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('start_here.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Start here </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#using_the_sdk">Using the Content Manager .NET SDK</a><ul><li class="level2"><a href="#tech_prereq">Technical Prerequisites and Assumptions</a></li>
<li class="level2"><a href="#bin_compat">Binary compatibility</a></li>
</ul>
</li>
<li class="level1"><a href="#sdkIntro">Content Manager .NET SDK</a></li>
<li class="level1"><a href="#usingTheSDK">Using the Content Manager .NET SDK</a></li>
<li class="level1"><a href="#sdkGettingStarted">Getting started</a><ul><li class="level2"><a href="#createRef">Creating a reference to the .NET SDK</a></li>
<li class="level2"><a href="#autotoc_md34">Downloading the .NET SDK from NuGet</a></li>
<li class="level2"><a href="#findingAssemblies">Finding Content Manager libraries at runtime</a><ul><li class="level3"><a href="#autotoc_md35">Code Example (with explicit initialization)</a></li>
<li class="level3"><a href="#autotoc_md36">Code Example (without explicit initialization)</a></li>
</ul>
</li>
<li class="level2"><a href="#dynamicSdkLoading">Loading TRIM.SDK.dll assembly dynamically</a></li>
<li class="level2"><a href="#memory_management">Memory Management</a><ul><li class="level3"><a href="#autotoc_md37">Examples</a></li>
<li class="level3"><a href="#autotoc_md38">Using statement</a></li>
<li class="level3"><a href="#autotoc_md39">Try/Finally</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md40">Leak tracking</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_10___Start"></a></p>
<h1><a class="anchor" id="using_the_sdk"></a>
Using the Content Manager .NET SDK</h1>
<h2><a class="anchor" id="tech_prereq"></a>
Technical Prerequisites and Assumptions</h2>
<p>As the name implies, the Content Manager .NET SDK components are based on Microsoft's .NET Framework. This documentation assumes the reader is a programmer with an understanding of .NET programming principles, the structure of .NET object models (i.e. objects, interfaces, methods and properties) and some experience of using a .NET-compliant programming language such as C# or C++.</p>
<p>The code examples in the documentation are in C#, although any .NET-compliant language can be used.</p>
<h2><a class="anchor" id="bin_compat"></a>
Binary compatibility</h2>
<p>Open Text will endeavor to maintain binary compatibility of the .NET SDK into the future. This means that a program developed against the Content Manager SDK will not need to be recompiled against future releases of Content Manager in order to run. It does NOT mean that:</p>
<ol type="1">
<li>Your applications will continue function in the same way. Testing your applications against new releases of Content Manager is essential.</li>
<li>Your code will not get compilation errors when recompiled against future releases of Content Manager</li>
</ol>
<p>The reason for any compilation errors or changes in functionality will be found in the SDK release notes, which document the history of any SDK changes from version to version of Content Manager.</p>
<h1><a class="anchor" id="sdkIntro"></a>
Content Manager .NET SDK</h1>
<p>This document describes the .NET Software Development Kit (.NET SDK) for Open Text Content Manager. It provides an introduction to the design and content of the .NET SDK, it gives instructions and guidance for using the various tools and objects, and is the logical starting point for the .NET SDK documentation suite.</p>
<p>For those wanting to understand the capabilities of the .NET SDK, this document can be read on its own. For those intending to use the .NET SDK, it serves as an orientation and introduction. For a complete technical understanding, you can add a reference to the .NET SDK (<code>TRIM.SDK.dll</code>) into the object browser of your chosen Integrated Development Environment (IDE), where you will be able to access detailed helpstrings for each object, method and property within the .NET SDK.</p>
<p>Effective integration of Content Manager with other applications using the .NET SDK requires a technical understanding of its tools, as well as a user perspective of the Content Manager application in general and (most importantly) a business understanding of the particular implementation of Content Manager and any other application for which an integration is required.</p>
<p>This document is about using the Content Manager .NET SDK; it will not discuss using the Content Manager Service API.</p>
<h1><a class="anchor" id="usingTheSDK"></a>
Using the Content Manager .NET SDK</h1>
<h1><a class="anchor" id="sdkGettingStarted"></a>
Getting started</h1>
<h2><a class="anchor" id="createRef"></a>
Creating a reference to the .NET SDK</h2>
<p>From your .NET IDE you need to find 'Add Reference' either under 'Project' on the menu or in the 'Solution Explorer' window and then select the '<code><a class="el" href="namespace_t_r_i_m_1_1_s_d_k.html">TRIM.SDK</a></code>' component from the .NET tab. You might want to add '<code>using <a class="el" href="namespace_t_r_i_m_1_1_s_d_k.html">TRIM.SDK</a>;</code>' (for C#), or your language's equivalent, to your code, so that you no longer need to reference it each time you use one of Content Manager objects methods and properties.</p>
<p>NOTE: In Content Manager 9.4 and earlier, the SDK assembly was named <code>HP.HPTRIM.SDK.dll</code>. Beginning with Content Manager 10.0, usage of <code>HP.HPTRIM.SDK.dll</code> is deprecated, and existing SDK applications should be migrated to using <code>TRIM.SDK.dll</code> instead. For more information, please see the relevant <a class="el" href="release_notes.html#rn_10_SdkRename">release note</a>.</p>
<h2><a class="anchor" id="autotoc_md34"></a>
Downloading the .NET SDK from NuGet</h2>
<p>The Content Manager .NET SDK is also available as a <a href="https://www.nuget.org/packages/MicroFocus.ContentManager.SDK/">NuGet package</a> which can be downloaded from the public <a href="https://www.nuget.org/">NuGet</a> repository. To access the SDK this way, use your NuGet browser to search the NuGet repository for <code>MicroFocus.ContentManager.SDK</code>, and select the SDK version that is relevant to you.</p>
<p>For example, in Visual Studio:</p>
<ol type="1">
<li>In the Solution Explorer window, right-click on your solution.</li>
<li>Select "Manage NuGet packages for Solution...".</li>
<li>Press "Browse" and make sure "Package source" is set to <code>nuget.org</code>.</li>
<li>Enter <code>MicroFocus.ContentManager.SDK</code> into the search bar.</li>
<li>Select the relevant version of the SDK, and press Install.</li>
</ol>
<h2><a class="anchor" id="findingAssemblies"></a>
Finding Content Manager libraries at runtime</h2>
<p>.NET uses a process called "Fusion" to locate modules at run time. Content Manager, however, loads all required native code libraries independently of Fusion when the method <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_application_base.html#a3d25b2c713b90ebb08f7f39763ab2951">TrimApplication.Initialize()</a> is called. This provides better error reporting in case something goes wrong. Currently this logic is implemented as follows:</p><ul>
<li>If the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_application_base.html#a30828d7645e47eeae5047cdd4f338757">TrimApplication.TrimBinariesLoadPath</a> property is set, then search for <code>tsjApi.dll</code> in that location (and don't try any other paths at all).</li>
<li>Search for <code>tsjApi.dll</code> in the same folder as <code>TRIM.SDK.dll</code>.</li>
<li>Search for <code>tsjApi.dll</code> in a sub-folder named <code>x86</code> or <code>x64</code>, of the folder containing <code>TRIM.SDK.dll</code>.</li>
<li>Search for <code>tsjApi.dll</code> in the folder specified by the Content Manager MSI registry key: (<code>HKEY_LOCAL_ MACHINE\\SOFTWARE\\Micro Focus\\Content Manager\\MSISettings\\INSTALLDIR</code>)</li>
<li>Search for <code>tsjApi.dll</code> in folders that are on the PATH environment variable.</li>
</ul>
<p>It is recommended to call <code>TrimApplication.Initialize()</code> explicitly as the first Content Manager related call in your code. This results in a simpler error message if something does go wrong.</p>
<h3><a class="anchor" id="autotoc_md35"></a>
Code Example (with explicit initialization)</h3>
<div class="fragment"><div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    TrimApplication.Initialize();</div>
<div class="line">    <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> objDB = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>();</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">{</div>
<div class="line">    System.Diagnostics.Trace.WriteLine(e.Message);</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">TRIM.SDK.BaseObjectTypes.Database</a></div><div class="ttdeci">@ Database</div></div>
</div><!-- fragment --><p> If you omit <code>TrimApplication.Initialize()</code>, and there is a subsequent load error, the error will need to be 'dug out' through exceptions.</p>
<h3><a class="anchor" id="autotoc_md36"></a>
Code Example (without explicit initialization)</h3>
<div class="fragment"><div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> objDB = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>();</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (Exception e)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">while</span> (e != <span class="keyword">null</span>)</div>
<div class="line">    {</div>
<div class="line">        System.Diagnostics.Trace.WriteLine(e.Message);</div>
<div class="line">        e = e.InnerException;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="dynamicSdkLoading"></a>
Loading TRIM.SDK.dll assembly dynamically</h2>
<p>It is possible in .NET to load .NET assemblies dynamically, from paths that are not known until runtime. This is typically done by hooking into the <code>AppDomain.CurrentDomain.AssemblyResolve</code> event, and adjusting the load path of the relevant assembly.</p>
<p>This technique can be useful when deploying SDK applications to end user systems where the installed path of Content Manager may vary. In this case, you will need to use Content Manager-specific registry settings to locate the Content Manager installation, and then load <code>TRIM.SDK.dll</code> from that location.</p>
<p>A code sample demonstrating dynamic loading of <code>TRIM.SDK.dll</code> is available <a href="https://github.com/HPECM/Community/tree/master/Samples/SDK/CSharp/SDKLocationResolver">here</a>.</p>
<h2><a class="anchor" id="memory_management"></a>
Memory Management</h2>
<p>Any SDK object that implements <code>System.IDisposable</code> must be explicitly disposed to avoid memory leaks and potential corruption. SDK objects implementing <code>IDisposable</code> include:</p><ul>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database.html">Database</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database_connection_pool.html">DatabaseConnectionPool</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_download_notifier.html">DownloadNotifier</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_object_change_notifier.html">TrimObjectChangeNotifier</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_wgs_progress_notifier.html">WgsProgressNotifier</a></li>
</ul>
<p>This means that any code that instantiates these objects must utilize either a <code>using</code> statement, or a <code>try</code>/<code>finally</code> block, to ensure that <code>Dispose()</code> is called before the object goes out of scope.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
Examples</h3>
<h3><a class="anchor" id="autotoc_md38"></a>
Using statement</h3>
<div class="fragment"><div class="line"><span class="keyword">using</span> (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> database = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>())</div>
<div class="line">{</div>
<div class="line">    database.Id = <span class="stringliteral">&quot;I1&quot;</span>;</div>
<div class="line">    database.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div>
<div class="line">    database.Connect();</div>
<div class="line">}</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md39"></a>
Try/Finally</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> database = <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    database = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>();</div>
<div class="line">    database.Id = <span class="stringliteral">&quot;I1&quot;</span>;</div>
<div class="line">    database.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div>
<div class="line">    database.Connect();</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">finally</span></div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (database != <span class="keyword">null</span>)</div>
<div class="line">    {</div>
<div class="line">        database.Dispose();</div>
<div class="line">        database = <span class="keyword">null</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md40"></a>
Leak tracking</h2>
<p>The SDK provides a leak tracking mechanism, for reporting and tracking down SDK objects that are not properly disposed. Leak tracking can be enabled and disabled using the <code>TrimApplication.EnableSdkLeakTracking()</code> method. Leak tracking is enabled by default.</p>
<p>When leak tracking is enabled, the first leak of an object will be reported to the Windows application event log, with a message containing the call stack location where the object was allocated. Subsequent leaks can be retrieved by calling <code>TrimApplication.GetSdkLeakCount()</code> and <code>TrimApplication.GetSdkLeakStackTraces()</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
